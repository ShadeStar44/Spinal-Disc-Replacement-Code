import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import itertools
import tkinter as tk
from tkinter import filedialog

#extension,(4N),data,converted,to,degrees
tc=np.array([2,2.05,2.1,2.15,2.2,2.25,2.30198,2.35365,2.40358,2.45421,2.50322,2.55384,2.60384,2.65565,2.70225,2.75206,2.80139,2.85108,2.90339,2.95085,3])
ur1c= np.array([-0.0319997,-0.036271,-0.0484189,-0.0657312,-0.0871508,-0.112005,-0.140835,-0.171156,-0.2013,-0.232071,-0.261775,-0.292244,-0.322156,-0.352609,-0.379413,-0.406835,-0.432487,-0.455979,-0.478146,-0.496726,-0.515118])
ur2c= np.array([0.0185536,0.0206094,0.0213386,0.0217489,0.0220589,0.0222341,0.0222687,0.0220506,0.0214038,0.0203064,0.0192543,0.0181288,0.0173836,0.0176887,0.0187696,0.0194722,0.0196253,0.0188945,0.0178656,0.01686,0.016028])
ur3c= np.array([0.0202672,0.021677,0.0223754,0.0233417,0.024679,0.0260607,0.0271815,0.02806,0.0284661,0.0283696,0.0283674,0.028556,0.028957,0.0304848,0.0322734,0.0338291,0.0348248,0.0350766,0.035294,0.0354414,0.03574])
ur1c = (ur1c *180/np.pi) + .0319997
ur2c= ur2c *180/np.pi + -.0185536
ur3c = ur3c *180/np.pi + -0.0202672
#flexion,(4P),data,converted,to,degrees
ur1d=np.array([-0.0319997,0.00389252,0.0348483,0.0703545,0.0900133,0.11159,0.130098,0.143218,0.158533,0.186229,0.196927,0.215284,0.231184,0.248318,0.262052,0.279106,0.293688,0.309059,0.324072,0.339906,0.352122])
ur2d=np.array([0.0185536,0.0241052,0.0246902,0.0253793,0.0262051,0.0275428,0.0288161,0.0296834,0.0306219,0.0321195,0.0326377,0.0335493,0.0343503,0.0352058,0.0358784,0.0366691,0.0373024,0.037916,0.0384938,0.0390798,0.0395164])
ur3d=np.array([0.0202672,0.0229277,0.021961,0.0206938,0.0200804,0.0196271,0.0191635,0.018731,0.0182271,0.017534,0.0173295,0.0170228,0.0167898,0.0164727,0.0162465,0.0160864,0.0159607,0.0157726,0.0155582,0.0153346,0.0151522])
ur1d = (ur1d *180/np.pi) + -.0319997
ur2d= ur2d *180/np.pi + -.0185536
ur3d = ur3d *180/np.pi + -0.0202672
#lateral,bending,(5N),data,converted,to,degrees
ur1c5=np.array([-0.0319997,-0.0150614,-0.0126369,-0.015703,-0.0241264,-0.0344685,-0.0451262,-0.0578625,-0.0734132,-0.0860254,-0.10203,-0.109978,-0.120067,-0.126419,-0.132856,-0.139235,-0.144846,-0.151507,-0.155841,-0.161869,-0.165347])
ur2c5=np.array([0.0185536,-0.000297575,-0.0139246,-0.0345019,-0.0538113,-0.071081,-0.0856138,-0.101119,-0.118804,-0.133043,-0.151144,-0.16058,-0.173177,-0.181335,-0.190135,-0.199255,-0.207297,-0.216626,-0.222788,-0.231371,-0.236296])
ur3c5=np.array([0.0202672,0.00307444,-0.00875065,-0.0261885,-0.0407351,-0.0526593,-0.0620954,-0.071985,-0.0834492,-0.0923646,-0.102976,-0.10837,-0.115462,-0.119773,-0.124312,-0.128977,-0.133095,-0.137925,-0.141052,-0.145407,-0.147977])
ur1c5 = (ur1c5 *180/np.pi) + -.0319997
ur2c5= ur2c5 *180/np.pi + -.0185536
ur3c5 = ur3c5*180/np.pi + -0.0202672
#lateral,bending,(5P),data,converted,to,degrees
ur1d5=np.array([-0.0319997,-0.0159436,-0.0143234,-0.0210493,-0.0320463,-0.0444435,-0.0603645,-0.0788466,-0.0898276,-0.103536,-0.115535,-0.127375,-0.133856,-0.139559,-0.144357,-0.14915,-0.155203,-0.158567,-0.163189,-0.168702,-0.171682])
ur2d5=np.array([0.0185536,0.0415435,0.0654299,0.0860157,0.105436,0.122971,0.142769,0.164509,0.177366,0.192921,0.206459,0.220092,0.228392,0.236253,0.24363,0.251079,0.260347,0.265413,0.272245,0.280231,0.284598])
ur3d5=np.array([0.0202672,0.0385623,0.0590586,0.076954,0.093285,0.107499,0.123293,0.1398,0.149107,0.159229,0.16769,0.175841,0.180769,0.184966,0.188748,0.192561,0.197329,0.199924,0.203421,0.207509,0.209695])
ur1d5 = (ur1d5 *180/np.pi) + -.0319997
ur2d5= ur2d5 *180/np.pi + -.0185536
ur3d5 = ur3d5 *180/np.pi + -0.0202672
#axial,rotation,(6N),data,converted,to,degrees
ur1c6=np.array([-0.0319997,-0.013327,-0.00280019,0.00253255,0.00523459,0.00590057,0.00681687,0.0081967,0.00922761,0.0107861,0.012305,0.0137163,0.0155002,0.0175906,0.0198882,0.0222584,0.024395,0.0258365,0.0280114,0.0302484,0.0324258])
ur2c6=np.array([0.0185536,0.00680311,-0.0068287,-0.0179965,-0.0321262,-0.0372394,-0.0447042,-0.0547034,-0.0604366,-0.0672615,-0.073439,-0.0783176,-0.0838044,-0.0892792,-0.094479,-0.0999936,-0.10481,-0.107697,-0.111589,-0.115215,-0.118475])
ur3c6=np.array([0.0202672,-0.00205289,-0.0251196,-0.0441319,-0.0664717,-0.0743273,-0.0857961,-0.101635,-0.11106,-0.122659,-0.132955,-0.141044,-0.1504,-0.160052,-0.169488,-0.179609,-0.188634,-0.194158,-0.201826,-0.20925,-0.216098])
ur1c6 = (ur1c6 *180/np.pi) + -.0319997
ur2c6= (ur2c6 *180/np.pi) + -.0185536
ur3c6 = (ur3c6 *180/np.pi) + -0.0202672
#axial,rotation,(6P),data,converted,to,degrees
ur1d6=np.array([-0.0319997,-0.0131581,-0.0066929,-0.00257463,3.00028E-005,0.000886509,0.00193106,0.00235631,0.00342939,0.00473322,0.00648958,0.00829961,0.0102018,0.0128632,0.0163391,0.018903,0.0213039,0.0246185,0.0274554,0.0306835,0.0338541])
ur2d6=np.array([0.0185536,0.0411673,0.0544305,0.0673415,0.0824263,0.0901117,0.101397,0.110158,0.119774,0.125985,0.132752,0.139051,0.144436,0.150006,0.155616,0.159322,0.162551,0.166613,0.169924,0.173431,0.176555])
ur3d6=np.array([0.0202672,0.0497891,0.0721211,0.0954383,0.121845,0.135108,0.153124,0.165729,0.179901,0.189483,0.200259,0.210585,0.219462,0.229044,0.239301,0.246346,0.252625,0.260732,0.267529,0.27497,0.28185])
ur1d6 = ur1d6 *180/np.pi + -.0319997
ur2d6= ur2d6 *180/np.pi + -.0185536
ur3d6 = ur3d6 *180/np.pi + -0.0202672

#4N & 4P
u1z= np.concatenate((np.flip(ur1c[2:21]),ur1d))
u2z= np.concatenate((np.flip(ur2c[2:21]),ur2d))
u3z=np.concatenate((np.flip(ur3c[2:21]),ur3d))
t3= np.concatenate((2*(-1*np.flip(tc[2:21])+2),(tc-2)*2))

#5N & 5P
u1z5=np.concatenate((np.flip(ur1c5[2:21]),ur1d5))
u2z5=np.concatenate((np.flip(ur2c5[2:21]),ur2d5))
u3z5=np.concatenate((np.flip(ur3c5[2:21]),ur3d5))

#6N & 6P
u1c6=np.concatenate((np.flip(ur1c6[2:21]),ur1d6))
u2c6=np.concatenate((np.flip(ur2c6[2:21]),ur2d6))
u3c6=np.concatenate((np.flip(ur3c6[2:21]),ur3d6))

plots = np.linspace(1,3,3)
print(plots)

fig, axs = plt.subplots(3, 1, figsize=(10, 13), sharex=True)

# --- Plot 1: u1z, u2z, u3z ---
axs[0].plot(t3, u1z, label='ROM X-axis')
axs[0].plot(t3, u2z, label='ROM Y-axis')
axs[0].plot(t3, u3z, label='ROM Z-axis')
axs[0].set_title('Intact Model: Flexion/Extension')
axs[0].set_ylabel('ROM (deg)')
axs[0].grid(True)
axs[0].legend()

# --- Plot 2: u1z5, u2z5, u3z5 ---
axs[1].plot(t3, u1z5, label='ROM X-axis')
axs[1].plot(t3, u2z5, label='ROM Y-axis')
axs[1].plot(t3, u3z5, label='ROM Z-axis')
axs[1].set_title('Lateral Bending')
axs[1].set_ylabel('ROM (deg)')
axs[1].grid(True)
axs[1].legend()

# --- Plot 3: u1z6, u2z6, u3z6 ---
axs[2].plot(t3, u1c6, label='ROM X-axis')
axs[2].plot(t3, u2c6, label='ROM Y-axis')
axs[2].plot(t3, u3c6, label='ROM Z-axis')
axs[2].set_title('Axial Rotation')
axs[2].set_xlabel('Time')
axs[2].set_ylabel('ROM (deg)')
axs[2].grid(True)
axs[2].legend()

fig.savefig(f"New_ROM/Plots/IntactROM.png", dpi = 300)
plt.tight_layout()
plt.show()